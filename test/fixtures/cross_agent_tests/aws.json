[
  {
    "testname":"instance type, instance-id, availability-zone are all happy",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"test.type",
        "expected":"test.type",
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"test.id",
      "expected":"test.id",
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"us-west-2b",
      "expected":"us-west-2b",
      "timeout":false
      }
    }
  },
  {
    "testname":"instance type with invalid characters",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"<script>lol</script>",
        "expected":null,
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"test.id",
      "expected":"test.id",
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"us-west-2b",
      "expected":"us-west-2b",
      "timeout":false
      }
    },
    "metric": {
      "Supportability/utilization/aws/error": {
        "callCount":1
      }
    }
  },
  {
    "testname":"instance type too long",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz",
        "expected":null,
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"test.id",
      "expected":"test.id",
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"us-west-2b",
      "expected":"us-west-2b",
      "timeout":false
      }
    },
    "metric": {
      "Supportability/utilization/aws/error": {
        "callCount":1
      }
    }
  },
  {
    "testname":"instance type times out",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":null,
        "expected":null,
        "timeout":true
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"test.id",
      "expected":null,
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"us-west-2b",
      "expected":null,
      "timeout":false
      }
    }
  },
  {
    "testname":"instance id with invalid characters",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"test.type",
        "expected":"test.type",
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"<script>lol</script>",
      "expected":null,
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"us-west-2b",
      "expected":"us-west-2b",
      "timeout":false
      }
    },
    "metric": {
      "Supportability/utilization/aws/error": {
        "callCount":1
      }
    }
  },
  {
    "testname":"instance id too long",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"test.type",
        "expected":"test.type",
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz",
      "expected":null,
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"us-west-2b",
      "expected":"us-west-2b",
      "timeout":false
      }
    },
    "metric": {
      "Supportability/utilization/aws/error": {
        "callCount":1
      }
    }
  },
  {
    "testname":"instance id times out",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"test.type",
        "expected":null,
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":null,
      "expected":null,
      "timeout":true
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"us-west-2b",
      "expected":null,
      "timeout":false
      }
    }
  },
  {
    "testname":"availability zone with invalid characters",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"test.type",
        "expected":"test.type",
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"test.id",
      "expected":"test.id",
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"<script>lol</script>",
      "expected":null,
      "timeout":false
      }
    },
    "metric": {
      "Supportability/utilization/aws/error": {
        "callCount":1
      }
    }
  },
  {
    "testname":"availability zone too long",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"test.type",
        "expected":"test.type",
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"test.id",
      "expected":"test.id",
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":"zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz",
      "expected":null,
      "timeout":false
      }
    },
    "metric": {
      "Supportability/utilization/aws/error": {
        "callCount":1
      }
    }
  },
  {
    "testname":"availability-zone times out",
    "uris":{
      "http://169.254.169.254/2008-02-01/meta-data/instance-type":{
        "response":"test.type",
        "expected":null,
        "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/instance-id":{
      "response":"test.id",
      "expected":null,
      "timeout":false
      },
    "http://169.254.169.254/2008-02-01/meta-data/placement/availability-zone":{
      "response":null,
      "expected":null,
      "timeout":true
      }
    }
  }
]